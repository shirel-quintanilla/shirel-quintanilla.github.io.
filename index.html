<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>New Bar</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <script src="functions.js"></script> 
</head>

<body>
  <div class="topnav" >
    <select class = "select_one" name="searchIndex" title="The method of searching" aria-label="Search Index">
      <option value="Keyword" selected="" id="default_search_type">Keyword</option>
      <option value="Title">Title</option>
      <option value="StartOfTitle">Start of Title</option>
      <option value="Series">Series</option><option value="Author">Author</option>
      <option value="Subject">Subject</option>
      <option value="LocalCallNumber">Call Number</option></select>

    <script>
      //dropdowns NOT functional yet
      let select = document.querySelector(" .select_one")
      let indexType = "Keyword"
      const header = document.getElementById("stupidHeader");

        select.addEventListener("change", (e) => {
        indexType = '${e.target.value}';
        header.textContent = indexType;


      });
   </script>

    <select name="searchIndex" title="Place of Search" aria-label="Search Index" class = "test">
      <option value="in Library Catalog" selected="" id="default_search_type">in Library Catalog</option>
      <option value="in List">in List</option>
      <option value="in History & Archives">in History & Archives</option></select>


    <input type="text" placeholder="Search the catalog" id="term">

    <button class= "search" id="button" >Search</button>
    
    <script>
      //when search button is hit creates appropiate link
      const searchButton = document.getElementById("button");
      searchButton.addEventListener("click", () => {
        goToLink();
      }); 

  
      //modify link based on terms from user
      function goToLink() {
        let searchInput = document.getElementById("term");
        let term = searchInput.value;
        let resultspage = 'https://willmstwn.cwmars.org/?browseCategory=main_new_non_fiction';

        if (term == "") {
          window.location.assign(resultspage);
        } else{
          const termArray = term.split(" ");
          let terms = "";
          for (let i = 0; i < termArray.length; i++) {
            terms = terms + termArray[i] + "+";  
          }
          const newTerms = terms.slice(0, -1); 

          resultspage = 'https://willmstwn.cwmars.org/Union/Search?view=list&lookfor=' + newTerms + '&searchIndex=' + indexType + '&searchSource=local';
          window.location.assign(resultspage);
        }
      }

    </script>
  </div>
</body>
</html>
